<html>
<head>
  <script>
  window.setInterval(tick, 1000);

  var numTodos = 0;
  var productivity = 0;
  var legalPads = 0;
  var todoApps = 0;
  var pythonScripts = 0;

  function tick () {
    console.log("tick");
    updateDisplay();
    updateModel();
  }

  // manual controls
  function userClick () {
    if (numTodos > 0) {
      numTodos -= 1;
      productivity += 1;
    }
    updateDisplay();
  }

  function buyLegalPad () {
    if (productivity >= legalPads) {
      productivity -= legalPads;
      legalPads += 1;
    }
    updateDisplay();
  }

  function buyTodoApp () {
    if (productivity >= todoApps * 35) {
      productivity -= todoApps * 35;
      todoApps += 1;
    }
    updateDisplay();
  }

  function buyPythonScript () {
    if (productivity >= 3500 * pythonScripts * pythonScripts + 3500) {
      productivity -= 3500 * pythonScripts * pythonScripts + 3500;
      pythonScripts += 1;
    }
    updateDisplay();
  }

  // update displays
  function updateDisplay () {
    displayNumTodos();
    displayProductivity();
    displayLegalPads();
    displayTodoApps();
    displayPythonScripts();
  }

  function displayNumTodos () {
    let newString = numTodos + " todos";
    document.getElementById("numTodos").innerText = newString;
  }

  function displayProductivity () {
    let newString = productivity + " productivity points";
    document.getElementById("productivity").innerText = newString;
  }

  function displayLegalPads () {
    let newString = legalPads + " legal pads";
    document.getElementById("legalPads").innerText = newString;
    document.getElementById("legalPadButton").disabled = productivity < legalPads;
    document.getElementById("legalPadButton").innerText = "buy a legal pad (" + legalPads + " productivity)";
  }

  function displayTodoApps () {
    let newString = todoApps + " todo apps";
    document.getElementById("todoApps").innerText = newString;
    document.getElementById("todoAppButton").disabled = productivity < todoApps * 35;
    document.getElementById("todoAppButton").innerText = "install a todo app (" + todoApps * 35 + " productivity)";
  }

  function displayPythonScripts () {
    let newString = pythonScripts + " python scripts";
    document.getElementById("pythonScripts").innerText = newString;
    document.getElementById("pythonScriptButton").disabled = productivity < pythonScripts * pythonScripts + 3500;
    document.getElementById("pythonScriptButton").innerText = "write a python app (" + (pythonScripts * pythonScripts + 3500) + " productivity)";
  }

  // update model
  function updateModel () {
    incrementTodos();
    incrementProductivity();
  }

  function incrementTodos () {
    numTodos++;
    numTodos += legalPads;
    numTodos += todoApps * 5;
  }

  function incrementProductivity () {
    if (productivity > 0) {
        productivity += Math.floor(Math.log(productivity)) * pythonScripts;
    }
  }
  </script>
</head>

<body>
  <div id="numTodos"></div>
  <div id="productivity"></div>
  <button onclick="userClick()">push</button>
  <div>
    <div><b>Todo Generators</b></div>
    <div>
      <div id="legalPads"></div>
      <button id="legalPadButton" onclick="buyLegalPad()"></button>
    </div>
    <div>
      <div id="todoApps"></div>
      <button id="todoAppButton" onclick="buyTodoApp()"></button>
    </div>
  </div>
  <div>
    <div><b>Productivity Booststers</b></div>
    <div>
      <div id="pythonScripts"></div>
      <button id="pythonScriptButton" onclick="buyPythonScript()"></button>
    </div>
  </div>
</body>

</html>
